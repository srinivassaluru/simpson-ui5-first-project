sap.ui.define(["sap/ui/core/util/MockServer","sap/base/util/UriParameters","sap/base/Log","sap/ui/util/XMLHelper"],function(e,t,a,r){"use strict";var i,n="cp.c360DriverWaitTime/";return{init:function(){var s=new t(window.location.href),o=jQuery.sap.getModulePath(n+"manifest",".json"),u="",p=s.get("errorType"),l=p==="badRequest"?400:500,c=jQuery.sap.syncGetJSON(o).data,f=c["sap.app"].dataSources;for(var d in f){if(f.hasOwnProperty(d)){var g=f[d],h=jQuery.sap.getModulePath(n+g.settings.localUri.replace(".xml",""),".xml"),m=h.slice(0,h.lastIndexOf("/")+1),y=g.settings.localUri;if(g.settings&&g.settings.localUri){if(typeof g.type==="undefined"||g.type==="OData"){var v=jQuery.sap.getModulePath(n+g.settings.localUri.replace(".xml",""),".xml");i=new e({rootUri:/.*\/$/.test(g.uri)?g.uri:g.uri+"/"});i.simulate(v,{sMockdataBaseUrl:m,bGenerateMissingMockData:true});i.start()}}var x=g.settings.annotations||[];x.forEach(function(t){var a=f[t];var i=a.uri,s=jQuery.sap.getModulePath(n+a.settings.localUri.replace(".xml",""),".xml");new e({rootUri:i,requests:[{method:"GET",path:new RegExp(""),response:function(e){var t=jQuery.sap.sjax({url:s,dataType:"xml"}).data;e.respondXML(200,{},r.serialize(t));return true}}]}).start()})}}e.config({autoRespond:true,autoRespondAfter:s.get("serverDelay")||1e3});var M=i.getRequests(),U=function(e,t,a){a.response=function(a){a.respond(e,{"Content-Type":"text/plain;charset=utf-8"},t)}};if(s.get("metadataError")){M.forEach(function(e){if(e.path.toString().indexOf("$metadata")>-1){U(500,"metadata Error",e)}})}if(p){M.forEach(function(e){if(e.path.toString().indexOf(u)>-1){U(l,p,e)}})}i.start();a.info("Running the app with mock data")},getMockServer:function(){return i}}});