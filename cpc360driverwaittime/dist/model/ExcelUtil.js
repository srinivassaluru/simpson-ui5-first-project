sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/export/Spreadsheet","sap/m/MessageToast"],function(e,t,o){"use strict";return{exportToExcel:function(e,r){var a=e.getColumns(),g=[],i=e.getItems();a.forEach(function(e,t){if(e.getAggregation("header")&&e.getVisible()){var o=e.getAggregation("header").getText();g.push({label:o,property:"Column"+t})}});var n=[];i.forEach(function(e){var t=e.getCells(),o={};a.forEach(function(e,r){if(e.getAggregation("header")&&e.getVisible()){o["Column"+r]=t[r].getText()}});n.push(o)});var s="DWT"+"_"+r.getView().getModel("DataModel").getProperty("/Company")+"_"+r.getView().getModel("DateModel").getProperty("/SelectedYear")+"_"+r.getPerspectvieText(r.getView().getModel("DataModel").getProperty("/SelectedPerspective"));var l={workbook:{columns:g},dataSource:n,fileName:s},d=new t(l);d.build().then(function(){o.show("Spreadsheet export has finished")}).finally(d.destroy)}}});